/*!
 * NeepInsertable v0.1.0-alpha.0
 * (c) 2020 Fierflame
 * @license MIT
 */
import{mSimple as e,mName as t}from"@neep/core";function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let n,o,i,s;function c(e){Reflect.defineProperty(e,"insertable",{value:e.delivered.__NeepInsertable__,enumerable:!0,configurable:!0})}function a(e,{insertable:t,childNodes:r},{createElement:n,Deliver:o}){const{name:i,insertable:s}=e;if(!i&&s instanceof l)return n(o,{__NeepInsertable__:s},...r);if(!i)return r;if(s instanceof l){const t=s.get(i);return t?n(o,{__NeepInsertable__:s},t.map(t=>n(t.component,e,...r))):null}if(!(t instanceof l))return r;const c=t.get(i);return c?c.map(t=>n(t.component,e,...r)):null}function u(e){!function(e){n=e.encase,o=e.register,i=e.Error,s=e.addContextConstructor}(e),o("InsertView",a),o("insert-view",a),s(c)}e(a),t("InsertView",a);class l{constructor(e){r(this,"parent",void 0),r(this,"_groups",n(Object.create(null))),e instanceof l&&(this.parent=e)}add(e,t,r={}){"number"==typeof r&&(r={order:r});const n=this._groups;Array.isArray(t)||(t=[t]);const o=n[e]?[...n[e]]:[];o.push(...t.map(e=>Object.freeze({...r,component:e}))),o.sort(({order:e},{order:t})=>(e||0)-(t||0)),n[e]=o}remove(e,t){const r=this._groups,n=r[e];if(!n)return;if(!t)return void(r[e]=[]);const o=n.findIndex(e=>e.component===t);if(o<0)return;const i=[...n.slice(0,o),...n.slice(o+1)];r[e]=i}set(e,t,r={}){"number"==typeof r&&(r={order:r});const n=this._groups;Array.isArray(t)||(t=[t]);const o=t.map(e=>Object.freeze({...r,component:e}));n[e]=o}get(e,t){const r=this._groups[e]||[];if(!t||!this.parent)return[...r];const n=this.parent.get(e,"number"==typeof t?t-1:-1),o=[...n,...r];return r.length&&n.length&&o.sort(({order:e},{order:t})=>(e||0)-(t||0)),o}get view(){const e=(e,...t)=>a({...e,insertable:this},...t);return t("Insertable",e),Reflect.defineProperty(this,"view",{value:e,enumerable:!0,configurable:!0}),e}static get install(){return u}static get View(){return a}}r(l,"version","0.1.0-alpha.0");export default l;
