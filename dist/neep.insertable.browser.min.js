/*!
 * NeepInsertable v0.1.0-alpha.3
 * (c) 2020-2021 Fierflame
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@neep/core")):"function"==typeof define&&define.amd?define(["exports","@neep/core"],t):t((e=e||self).NeepInsertable={},e.Neep)}(this,(function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let r;function o(n,{childNodes:o}){const{name:i}=n;if("string"!=typeof i){const{insertable:e}=n;return e instanceof c?t.createElement(r,{value:e},...o()):t.createTemplateElement(o())}const{insertable:s}=n;if(s instanceof c){const e=s.get(i);return e?t.createElement(r,{value:s},e.map(e=>t.createElement(e.component,n,...o()))):null}const a=e.withInsertable();if(!a)return t.createTemplateElement(o);const l=a.get(i);return l?t.createTemplateElement(l.map(e=>t.createElement(e.component,n,...o()))):null}var i=[function(){r=t.createDeliverComponent()},function(){e.View=t.createShellComponent(o,{name:"InsertView"})},function(){t.register("InsertView",e.View),t.register("insert-view",e.View)},function(){e.withInsertable=t.createWith({name:"withInsertable",create:()=>t.withDelivered(r)})}];function s(e){}for(const e of i)e();class c{constructor(e){n(this,"parent",void 0),n(this,"_groups",t.encase(Object.create(null))),e instanceof c&&(this.parent=e)}add(e,t,n={}){"number"==typeof n&&(n={order:n});const r=this._groups;Array.isArray(t)||(t=[t]);const o=r[e]?[...r[e]]:[];o.push(...t.map(e=>Object.freeze({...n,component:e}))),o.sort(({order:e},{order:t})=>(e||0)-(t||0)),r[e]=o}remove(e,t){const n=this._groups,r=n[e];if(!r)return;if(!t)return void(n[e]=[]);const o=r.findIndex(e=>e.component===t);if(o<0)return;const i=[...r.slice(0,o),...r.slice(o+1)];n[e]=i}set(e,t,n={}){"number"==typeof n&&(n={order:n});const r=this._groups;Array.isArray(t)||(t=[t]);const o=t.map(e=>Object.freeze({...n,component:e}));r[e]=o}get(e,t){const n=this._groups[e]||[];if(!t||!this.parent)return[...n];const r=this.parent.get(e,"number"==typeof t?t-1:-1),o=[...r,...n];return n.length&&r.length&&o.sort(({order:e},{order:t})=>(e||0)-(t||0)),o}get view(){const e=t.createShellComponent((e,...t)=>o({...e,insertable:this},...t),{name:"Insertable"});return Reflect.defineProperty(this,"view",{value:e,enumerable:!0,configurable:!0}),e}static get install(){return s}static get View(){return e.View}static get version(){return"0.1.0-alpha.3"}}e.InsertView=e.View,e.default=c,e.install=s,e.version="0.1.0-alpha.3",Object.defineProperty(e,"__esModule",{value:!0})}));
